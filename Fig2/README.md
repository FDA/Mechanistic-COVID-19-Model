# This code generates "Figure 2 Disease model calibration." 

## Running the code---------------------------------------------------------
All simulations are run in R-4.0.2   
This code uses the following R packages:  
library(ggplot2   [version 3.3.3])  
library(gridExtra [version 2.3]  )  
library(grid      [version 4.0.2])  
library(optparse  [version 1.6.6])   
library(deSolve   [version 1.28] )  

## Folders and Files-------------------------------------------------------
"Data_Covid"        	includes the experimental data  
"Fig2"    	 			includes the output figures  
"Inputs_parameters" 	includes the input data  
"Model" 				includes the models in different formats  
"Main.R" 				is the main code for generating the figure 2  
"Plot_Optimum R" 		is a subroutine that is used in Main.R for plotting the Optimum case.  
"Plot_Population.R"     is a subroutine that is used in Main.R for plotting the Population case.  
## Running-----------------------------------------------------------------
Two different formats are provided for running the code to generate Figure 2:  
I)  There is a  *so  version of the model that is 		      Linux compatible, but Faster to run.   
PAHT: Model/delaymodelfun.so  
II) There is an *R   version of the model that is Windows and Linux compatible, but slower to run.  
PAHT: Model/delaymymod.R  

Note: the *so format of model can be compiled/generated by   
cd Model  

R CMD SHLIB delaymymod.c  
###---------------------------------------------------------------------------  
*To generate Figure 2, Just Optimum case:    
 
   The default is to generate , Optimum curve in mild cases by using an R version of the model:  
		Rscript Main.R  

   In severe case by using an *R version of the model:  
		Rscript Main.R -d severe  

   In mild case by using an *so version of the model:  
		Rscript Main.R -m C  

   In severe case by using an *so version of the model:  
		Rscript Main.R -d severe -m C  

*To generate Figure 2, Optimum curve + uncertainty band (2000 virtual patients)  
   In severe cases by using an *R version of the model:  
		Rscript Main.R -d severe -c Population  

   In mild cases by using an *R version of the model:  
		Rscript Main.R -c Population  

   In severe cases by using an *so version of the model:  
		Rscript Main.R -d severe -c Population -m C  

   In mild cases by using an *so version of the model:  
		Rscript Main.R -c Population -m C  

*To generate Figure 2 with a optional population (for example 113) in severe cases and *so version of model:  
Rscript Main.R -d severe -c Population -m C -p 113  

####-----------------------------------------------------  
The "readme" file and codes are written by:    
Mohammadreza Samieegohar
